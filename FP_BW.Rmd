---
title: "Linguistic Data Analysis - Final Project"
author: "Benedict Wuethrich"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#register_stadiamaps(key = "ENTER YOUR OWN KEY HERE",
#                    write = FALSE)
```


Everything related to this project can be found in [this GitHub repository](https://github.com/BendixY/LDAR-FP-BW).

```{r packages, include=FALSE}

library(tidyverse)
library(here)
library(ggmap)
library(ggthemes)
library(maps)
library(viridis)
library(rcldf)
```
## Introduction
On the Australian continent there are over 333 reported languages which can be roughly categorized into either Pama-Nyungan languages or Non-Pama-Nyungan languages. It is important to note that the latter does not imply any genealogical link of the included languages, while the former has been shown as a cohesive language family. Non-Pama-Nyungan is more of a collective term for Australian languages that aren't thought of as Pama-Nyungan and actually contain 27 different language families. Exactly which langauges belong to which category is an ongoing debate.

Pama-Nyungen languages have been spoken for over 5000 years, make up over 306 different identified languages and the speakers cover about 80% of the landmass (Bouckaert 2018, 741). Given this long history, it is likely that the Pama-Nyungan languages have been competing against Non-Pama-Nyungan languages for a long time and ended up limiting the Non-Pama-Nyungan languages to the northernmost part of the continent. Nowadays, both are having to compete against the English language.

One of the main actors in describing Australian languages is Robert M. W. Dixon. With "The Languages of Australia", he has published a comprehensive description of Australian languages as early as 1980 and another study of Australian Languages in 2004 in his monograph "Australian Languages. Their Nature and Development". But these works were not without their controversy. Dixon vehemently denied the applicability of the comparative method on Australian Languages, which lead to a rather large amount of discussion surrounding his works. Claire Bowern and Harold Koch wrote "Australian Languages. Classification and the comparative method". Dixon's skepticism is described as an erroneous phylogenetic assessment which is "so bizarrely faulted, and such an insult to the eminently successful practitioners of Comparative Method Linguistics in Australia, that it positively demands a decisive riposte."(O’Grady and Hale in Bowern and Koch, 2004: 69), which serves as a perfect summary for what the book tries to achieve.

In more recent publications, like the paper by Bouckaert et al. (2018), computer-assisted methods have gained ground. This paper specifically deals with the genealogy of Pama-Nyungan languages. Using their data consisting of basic vocabulary of 306 different Pama-Nyungan languages, they created a phylogenetic tree that shows the diversification of the Pama-Nyungan language family. Additionally, the same data was used to find a likely homeland of the family, which they postulated to be in the Gulf Plains region.

In this paper I will be looking at the geographical distribution of the Australian languages and how they compare to each other in terms of categories like word order or phoneme inventory. To make this both simpler to understand as well as simpler to execute, I will be adopting the reductionist point of view of pooling the Non-Pama-Nyungan languages into a single category.


## Data
The data used for this project originates from two cldf datasets, one being the WALS data, the other one being the phoible data. The WALS data was used predominately. 

The data wrangling for this project was relatively simple, since the data sets provided by WALS and phoible respectively are quite clean already. The biggest challenge posed was figuring out how to load cldf datasets into R and how to manipulate them appropriately. I struggled with that part for a while as it also had me refresh my memory on how the different join functions would behave.
I created a seperate Rscript file that entails all the necessary data wrangling and manipulation for the different plots and maps used in this project. The other scripts rely on this Data Wrangling script to be run first, so as to load the required dataframes. This Rmarkdown file compiles them all into one coherent document, though without saving the plots and maps again. 
```{r data_wrangling, include=FALSE}

##loading in data from phoible and WALS and limiting them to languages spoken in Australia
#Let's start with WALS

wals_cldf <- cldf(here("data/WALS/cldf"))
#this loads the cldf data, but is not yet manipulable. Do to this, we need to get it into a dataframe or tibble format
summary(wals_cldf)


#This creates a tibble that will be manipulated further at different points.
wals_value <- as.cldf.wide(wals_cldf, "ValueTable") %>% 
  filter(Macroarea == "Australia")
glimpse(wals_value)


#This following one is a simple dataframe that shows the different Australian languages. Only used once to create a map.
wals_lang <- read_csv(here("data/WALS/cldf/languages.csv")) %>% 
  filter( #Latitude >= -44 & Latitude <= -11 & 
           #Longitude >= 112 & Longitude <= 154 &
           Macroarea == "Australia",
           )
#boundaries were determined with the help of ChatGPT 4.o but ended up not being helpful enough. i left the code in in case i might need it at another time
glimpse(wals_lang)


#Now we do the same with the data by phoible
phoible_cldf <- cldf(here("data/phoible/cldf-datasets/cldf"))
summary(phoible_cldf)

phoible_value <- as.cldf.wide(phoible_cldf, "ValueTable") 
phoible_Language <- as.cldf.wide(phoible_cldf, "LanguageTable") %>% 
  filter(Macroarea == "Australia")

#We join these two to create a single tibble containing more information
phoible_joined <- phoible_Language %>% 
  left_join(phoible_value, by = c("ID" = "Language_ID"))



##Word Order Data Wrangling
#creates two seperate df, for PN and nPN respectively. Also renames relevant columns to be more descriptive.

wals_worder_PN <- wals_value %>% 
  filter( Chapter_ID == "81" &
            Family == "Pama-Nyungan") %>% 
  rename("WordOrder" = "Name.CodeTable")

wals_worder_nPN <- wals_value %>% 
  filter( Chapter_ID == "81" &
            Family != "Pama-Nyungan") %>% 
  rename("WordOrder" = "Name.CodeTable")

```

```{r AUS_map}

map_AUS <- get_stadiamap(bbox = c(left = 113, 
                                  bottom = -44,
                                  right = 154,
                                  top = -9), #here the map boundaries given by ChatGPT earlier came in handy again
                         zoom = 3,
                         maptype = "stamen_toner_lite",
                         color = "color")
ggmap(map_AUS)

#This map will show the distribution of PN and nPN languages. While reductionist, I want to make it easier to read, so I mutate all nPN languages to simply "Non-Pama-Nyungan"


wals_nPN <- wals_value %>% 
  mutate(Family = if_else(Family == "Pama-Nyungan", "Pama-Nyungan", "Non-Pama-Nyungan"))

map_AUS_family <- ggmap(map_AUS) +
  geom_point(data = wals_nPN,
             aes(x = Longitude,
                 y = Latitude,
                 color = Family),
             show.legend = T) +
  scale_color_colorblind() + #better color
  theme_map() + #removes axes labels and puts the legend in bottom left corner of map
  theme(legend.text = element_text(size = 10),
        legend.title = element_text(size = 12)) +
  labs(color = "Families")
map_AUS_family



#a different map that shows the dominant word order of Australian languages
#first we need to filter for data that entails the Word order. This is chapter 81 of WALS. we further seperate them by PN and nPN

##PN
map_PN_worder <- ggmap(map_AUS) +
  geom_point(data = wals_worder_PN,
             aes( x = Longitude,
                  y = Latitude,
                  color = WordOrder),
             show.legend = T) +
  theme_map() +
  theme(legend.text = element_text(size = 10),
        legend.title = element_text(size = 12)) +
  labs(color = "Dominant Word Order")
map_PN_worder

##nPN
map_nPN_worder <- ggmap(map_AUS) +
  geom_point(data = wals_worder_nPN,
             aes( x = Longitude,
                  y = Latitude,
                  color = WordOrder),
             show.legend = T) +
  theme_map() +
  theme(legend.text = element_text(size = 10),
        legend.title = element_text(size = 12)) +
  labs(color = "Dominant Word Order")
map_nPN_worder


```


```{r plots}

#PLOTS


##Word Order Plots

###Word Order PN
histo_PN_worder <- ggplot(data = wals_worder_PN,
                               aes(x = WordOrder,
                                   fill = WordOrder)) +
  geom_histogram(stat = "count") + # defining the type of plot
  labs(y = "Number of Languages",
       x= "Word Order") + # renaming the axes
  theme_bw() + # adjusting the theme
  scale_fill_colorblind(guide = FALSE) +
  ggtitle("Frequency of Word Orders in the Australian Languages") # adding a descriptive title
histo_PN_worder #getting a preview


###Word Order nPN

histo_nPN_worder <- ggplot(data = wals_worder_nPN,
                               aes(x = WordOrder,
                                   fill = WordOrder)) +
  geom_histogram(stat = "count") + # defining the type of plot
  labs(y = "Number of Languages",
       x= "Word Order") + # renaming the axes
  theme_bw() + # adjusting the theme
  scale_fill_colorblind(guide = FALSE) +
  ggtitle("Frequency of Word Orders in the Australian Languages") # adding a descriptive title
histo_nPN_worder #getting a preview


```

\newpage
## Bibliography

Bouckaert, Remco R., Claire Bowern & Quentin D. Atkinson (2018). The origin and expansion of Pama–Nyungan languages across Australia. Nature Ecology & Evolution (2), 741–749.  
Bowern, Claire / Koch, Harold (Hrsg.) (2004): Australian Languages. Classification and the comparative method. Amsterdam / Philadelphia: John Benjamins.  
Dixon, R.M.W. (1980): The Languages of Australia. Cambridge: Cambridge University Press.  
Dixon, R.M.W. (2004): Australian Languages. Their Nature and Development. Cambridge: Cambridge University Press.  
Greenhill, Simon (2024). rcldf: rcldf - Read Linguistic Data In The Cross Linguistic Data Format (CLDF)_. R package version 1.2.0, commit 3979a89dbe4db653873caca62212fc07ebb966e9, https://github.com/SimonGreenhill/rcldf  
Kahle, D., Wickham, H. ggmap: Spatial Visualization with ggplot2. The R Journal, 5(1), 144-161. http://journal.r-project.org/archive/2013-1/kahle-wickham.pdf  
Matthew S. Dryer. (2013) Order of Subject, Object and Verb. In: Dryer, Matthew S. & Haspelmath, Martin (eds.) WALS Online (v2020.3) [Data set]. Zenodo. https://doi.org/10.5281/zenodo.7385533 (Available online at http://wals.info/chapter/81, Accessed on 2024-04-16.)  
Moran, Steven & McCloy, Daniel (eds.) 2019. PHOIBLE. Jena: Max Planck Institute for the Science of Human History. (Available online at https://phoible.org)  
O’Grady, G. N. (1998). Toward a Proto-Pama-Nyungan Stem List, Part I: Sets J1-J25. Oceanic Linguistics, 37(2), 209–233.  
Schmidt, W. (1919). Die Gliederung der australischen Sprachen: geographische, bibliographische, linguistische Grundzüge der Erforschung der australischen Sprachen. Mechitharisten-Buchdruckerei.  
Wickham, H et al. (2019). Welcome to the tidyverse. Journal of Open Source Software,  4 (43), 1686. doi:10.21105/joss.01686 https://doi.org/10.21105/joss.01686  
Zuckermann, G. et al. (2021) LARA in the Service of Revivalistics and Documentary Linguistics: Community Engagement and Endangered Languages. Proceedings of the Workshop on Computational Methods for Endangered Languages (1), 13-23.  

